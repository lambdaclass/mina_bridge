// SPDX-License-Identifier: GPL-3.0
pragma solidity >=0.4.16 <0.9.0;

import {Test, console2} from "forge-std/Test.sol";
import "../lib/bn254/Fields.sol";
import "../lib/bn254/BN254.sol";
import "../src/Verifier.sol";
import "../lib/msgpack/Deserialize.sol";
import "../lib/Commitment.sol";
import "../lib/Alphas.sol";

contract KimchiVerifierTest is Test {
    bytes verifier_index_serialized =
        hex"DE0015A6646F6D61696E82A474797065A6427566666572A464617461DC00AC00400000000000000E00000000400000000000000000000000000000000000000000000000000000000000000140CCB0190CCCE6CC9CCC81CCABCC89CC97CCD87847CCBFCCC65752CCA76A7564CCA937631B66CCA7CCE1CC8C6330CC856E7C61CCC201CCAACCADCCE6CCAA2074CCE13ECCA9CCB4CCA8CCA8CCDC0DCCB8514E1FCC81CCE4CCD9CCCD5156CC962D10CC841C6434CCE9CCEECCF8CCC0717767CCB07609CCF4CC8C6ECC8E55420D6811CCE9CCE9CCE7066F031C28676666CCC6CCD4CCFBCCF3CCE7062D4ACCCACCE95CCCAECCA9CC8B56CCCD337CCCB5CCB949CCAACCD9135ACC94525B13AD6D61785F706F6C795F73697A65CD4000A77A6B5F726F777303A67075626C696300AF707265765F6368616C6C656E67657300AA7369676D615F636F6D6D9782A9756E736869667465649182A474797065A6427566666572A464617461DC0020343FCC9B2FCC88177D5317CCC5CCE46D58775535CCFBCCF727CCAECCFDCC9ACC8F7CCCD71FCC97CCB65DCCF3CC88CC89A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC002023CCF6CCC24D796DCCB1CC9CCCF34A55CCB42ECCFFCC9622CCEC131A17CCC77ECCED1ECCF615CCB51B77CCA2CCA727A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC0020CCA318CC805ACC9B2A0DCCD6CCF3CCDDCCBCCC87CCA8CCD9CCBBCCD8CCB057CCA2CCB04C171A56CCEFCCD9CC95CCB658CC8FCC9DCC8CA773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC0020CC83CCB4CCD87413CCCBCC8460CCF7CCE5CCE6CCC7CCA7CCE66E04CCCA37052DCC8A2616CCD2CCB536CC8857CCA154CCC01BA773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00202CCCFB36CCC12B283DCCEBCCE1CC9ECC897B7ACC9503CCE71F0A285257CCA2CCC0CC9DCCF5CCC060CCF1CCB638CCB2CCA9A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00206279CCCA3F690052CCE84B191FCCEB56CCCB18CCE51814CCE3CCEE473040CC8ACCA9CCECCC9F0CCC87CCA3CCB6CC87A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC0020CCE320265164CC8FCCCFCC98CCA9CC9322CC874C246DCCEBCCFFCCBB67796E184E50171ACCA43E54413D2BA773686966746564C0B1636F656666696369656E74735F636F6D6D9F82A9756E736869667465649182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000040A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000040A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000040A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000040A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000040A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000040A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000040A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000040A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000040A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000040A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000040A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000040A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000040A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000040A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000040A773686966746564C0AC67656E657269635F636F6D6D82A9756E736869667465649182A474797065A6427566666572A464617461DC0020723737CCCF1CCCC96BCCB40021504A4FCCF45D21CC914ECC94CC84CCF2113D66545A3826CC91CC9ACC9C25A773686966746564C0A870736D5F636F6D6D82A9756E736869667465649182A474797065A6427566666572A464617461DC0020723737CCCF1CCCC96BCCB40021504A4FCCF45D21CC914ECC94CC84CCF2113D66545A3826CC91CC9ACC9C25A773686966746564C0B1636F6D706C6574655F6164645F636F6D6D82A9756E736869667465649182A474797065A6427566666572A464617461DC0020723737CCCF1CCCC96BCCB40021504A4FCCF45D21CC914ECC94CC84CCF2113D66545A3826CC91CC9ACC9C25A773686966746564C0A86D756C5F636F6D6D82A9756E736869667465649182A474797065A6427566666572A464617461DC0020723737CCCF1CCCC96BCCB40021504A4FCCF45D21CC914ECC94CC84CCF2113D66545A3826CC91CC9ACC9C25A773686966746564C0A9656D756C5F636F6D6D82A9756E736869667465649182A474797065A6427566666572A464617461DC0020723737CCCF1CCCC96BCCB40021504A4FCCF45D21CC914ECC94CC84CCF2113D66545A3826CC91CC9ACC9C25A773686966746564C0B3656E646F6D756C5F7363616C61725F636F6D6D82A9756E736869667465649182A474797065A6427566666572A464617461DC0020723737CCCF1CCCC96BCCB40021504A4FCCF45D21CC914ECC94CC84CCF2113D66545A3826CC91CC9ACC9C25A773686966746564C0B172616E67655F636865636B305F636F6D6D82A9756E736869667465649182A474797065A6427566666572A464617461DC00206FCCA61A22CC83CCA1061BCCF23F57CC92CCB4CCDCCCABCC94CCB7CCA62E2F612FCCAC28CC9006CCF54ECCE007CCA02CA773686966746564C0B172616E67655F636865636B315F636F6D6D82A9756E736869667465649182A474797065A6427566666572A464617461DC0020CCBD4ECCFDCCF0CC984E25CCA1CCC0CC81CCCECCEFCCD1CC83CCEECCD03BCCC44FCC8F50CC97CCA308CCFBCCC420CCC24F5B25CCA1A773686966746564C0B6666F726569676E5F6669656C645F6164645F636F6D6DC0B6666F726569676E5F6669656C645F6D756C5F636F6D6DC0A8786F725F636F6D6DC0A8726F745F636F6D6DC0A573686966749782A474797065A6427566666572A464617461DC0020010000000000000000000000000000000000000000000000000000000000000082A474797065A6427566666572A464617461DC0020CCE3CCA214CCE91334CCD0CCCACCF1CCEBCC85CCDF5BCCD7524D73CCD5CCEB7ACCAF742A7ECCB2CCD40BCCFDCCC8CCCDCCB90082A474797065A6427566666572A464617461DC00206D0F4433CC9A33CC9FCCB8CCA4CCE4CC9BCCF109CC9620CCAA64CC9918482BCC95CCA3CC97CCAE39CCB9CCEC5ACCD4770082A474797065A6427566666572A464617461DC0020CCB40923CCBD78CCE619CCC80A7B39CCC0CCF3CCF11E48005519CCD2CCFECCF16A1F77CCD40545CCE5CCC7770082A474797065A6427566666572A464617461DC0020CCF9CCC95CCCD6CCB11B38CCDF7855CCFD4D2A036329CCADCCCACCD613CCF100CCB92310CC9540356A597C0082A474797065A6427566666572A464617461DC00205A696526CCFA30CC9C412C10CCE86604CCC3CCC0CCAD2CCCD9443DCCD85BCC8232037212CC81CCCFCCBF330082A474797065A6427566666572A464617461DC002043423BCCB307CCCECCC1CC9F297C41CC88CCDECCB23ACCCC7B581271CC9B2ECCACCCCBCCF1CCB7034ACCE6CCACCCE800AC6C6F6F6B75705F696E64657886B16A6F696E745F6C6F6F6B75705F75736564C2AC6C6F6F6B75705F7461626C659182A9756E736869667465649182A474797065A6427566666572A464617461DC002076776ACC8074CCC4CC8F7FCCEDCC96CCC7CCD2CCEFCC84CCF1CCB2CC90CC8E3CCCE46ACC93CCE0CCA86E2A68CCEF7B705620A773686966746564C0B06C6F6F6B75705F73656C6563746F727384A3786F72C0A66C6F6F6B7570C0AB72616E67655F636865636B82A9756E736869667465649182A474797065A6427566666572A464617461DC002065CC96CCFFCC867604CCDD1A633CCCFECC914ACCF177CCAACCE5124239CCD9CCC8CCC80D36512FCCF764CCBE01CC97A773686966746564C0A566666D756CC0A97461626C655F69647382A9756E736869667465649182A474797065A6427566666572A464617461DC0020CCAD24CC87CCD4CCBF401CCC97CCB4CC95CCB215CCDECC95051CCC861A795F3ECC8204695D14515ACCFECC8CCCC8CC9FA773686966746564C0AB6C6F6F6B75705F696E666F83AB6D61785F7065725F726F7704AE6D61785F6A6F696E745F73697A6501A8666561747572657383A87061747465726E7384A3786F72C2A66C6F6F6B7570C2AB72616E67655F636865636BC3B1666F726569676E5F6669656C645F6D756CC2B16A6F696E745F6C6F6F6B75705F75736564C2B3757365735F72756E74696D655F7461626C6573C2B772756E74696D655F7461626C65735F73656C6563746F72C0";
    bytes prover_proof_serialized =
        hex"85AB636F6D6D69746D656E747384A6775F636F6D6D9F82A9756E736869667465649182A474797065A6427566666572A464617461DC00203A5ACCA578CCF1110856CCF10702CCCE4C056A07CC88CCBE32CCEE326BCCBF2DCCA919CCF327CCC90D2E03A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC0020CCB6CCF3367671CCF1CCED3C2F3D1DCCEBCC88CCC64E4F744BCC91CC886CCC90592ECCB85312CCC1CCB01C75CC82A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC0020CCBDCCF900CC89CCF3CCBFCC8170CC801960CCC5CCECCCE9CCCC0D78CC8820555CCCABCCE5741B46CC8B184560CCAA03A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC0020CCDFCC862F1E3BCCEF58CCD8CCBD5FCCC66BCCA6CCB6CCDDCCAB7F7772CCAE17CCFC58707D18CCBACC91CCA032CCFF0FA773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC002006CC82606649CCB401074CCCE147CCC0CCA823096ACCFB7D1BCCAECCB967CC90696D3807CCD5CC86CC93790CA773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC0020CCE5055DCCA536CCF33529CCA101CC9B74CCC170CCBCCCFC1ECCCB004BCCAACC8DCCD1CC8DCC9B7213294ACCA1632CA773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC0020CCE3CCFECCE3CC996113CC93CCD7CCDACCD3CCDA7DCCD43124CCF530CCBA0411CC8FCC9DCC802ACC903F30603FCC8574CC88A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC0020CCEF367FCCD5CC9561CCD04364CCD674CCE961463DCCD36BCC80CC8A0BCCD4CCDB1DCCEECCC7CCFC09CCAF5F72CC872BA773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC002044CC8734CCF7506406CCB7CCE5656FCCCD5BCC9D51CCD2CCFBCCD2CCFDCC9FCCB45FCCE759CC9111470ACCB506CCCB19A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC0020CC83CCF7CCDECC94CC9165041147CCAFCCA346106ACCB8CCF475CCDFCC87CC9A7CCC9CCC8D27CC97CCA3CC9976CCFFCCD3540CA773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC0020CCE0CCA6CCF0CCE4CCD2537E1FCCBFCCC4390C036CCCF972510FCCA703CCADCCB5CCEACCFE51CCEDCCB3262438CCBE20A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC0020740E33CCF9CCF5670454CCD14168CCE1CCFD34CCF6CCC90F706262CCEC2ECC9FCCF445054E63CCAECCFD0FCCAEA773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC0020CC90100D1FCC93CCF4CC99CC817637CC8920CC80CCC4CCA6213CCCFACCD3CC920C4A0ECCE26C19CCE9CC9D37CC94CCE30AA773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC002055575BCC9811CC80CCDB213B37CC9ECCC9CCF8CCD1CCAD7ECC946DCC9B4758CCFECCF11949CCCBCCA0CCE9CC9C5953CC8BA773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC0020CC880E7F2DCCA7CCD8CCC3CCAD090BCCC9CCFBCCBBCCABCCD3CCC84038497A3A7DCCC7CCDD6920CCBA2DCCBBCCEBCCA6CC88A773686966746564C0A67A5F636F6D6D82A9756E736869667465649182A474797065A6427566666572A464617461DC0020011B6BCCCF7645CCA7CCECCCF7CCE94F5F14285ECCC0CC9042CCBB45CCE014CC9B34797275415E4DCCE1CC82A773686966746564C0A6745F636F6D6D82A9756E736869667465649782A474797065A6427566666572A464617461DC0020CCE726CCA0CC9A10CC9322CCFE1F0B0BCC9DCC922ACCC1CC80CCF47BCCD9633F0DCCB8723FCCDF2CCCC0CCEBCCC2CCC80182A474797065A6427566666572A464617461DC0020CCDB427DCCEECCC41B07CCFCCC82CCB44DCCDDCCD7CCED1B0DCCD3CC890E30563ACCD525036228CCF61801CCFE2482A474797065A6427566666572A464617461DC0020CCF149656ECCC940CC80CCE857CCCDCCCFCCF605CC826ECCB8255DCCEBCCD52CCCC56C6037510B60CC91CC9A19CCA682A474797065A6427566666572A464617461DC0020CC8F65CCD379CCB1CCE31C56CCDF6262CC84CC9FCCFACCB0CCFB6E244FCC9D42106FCCA823CC8DCCFDCCBF1E4CCCF3CC9882A474797065A6427566666572A464617461DC0020CC88CCEE08444616CCD422712558CC8D1CCCAECCF3CCEA68735C0829CC8B2609CCB90976CCB8211ACCF72282A474797065A6427566666572A464617461DC002013CCC81D5ACCC4CC9DCC8920CCA54F080F5609CC9FCCCDCCBECCB960CCB06F1CCC8666CCE5040164CCAECCA9273082A474797065A6427566666572A464617461DC0020CCA67922CCCD5BCCBECCA556CCA1CC9C18CCF5CCF07DCCF56ECCA4CC8705CC866DCCD16831CCDE18CC9FCCF24FCC804ACCA4A773686966746564C0A66C6F6F6B757083A6736F727465649582A9756E736869667465649182A474797065A6427566666572A464617461DC0020CCB84D5E0FCCAE7760CCB5CCDDCCF4760CCCBA2033CC93CCEA4449CCE4CCB6CCF871CCC40D68CC81CCB2CCE6CCEECC8E0EA773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00205E377A5E2E7DCCF7017CCC8940CCCECC9925310F6CCCA2481A5C02CCB23ACCD6774A0F12395BCC8FA773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC00206ECCA1CCD636CCD6182C5F07CCDC67CCC84F397947CCAECCB74CCCBE41CCB3CCA1CC807600416FCCC050CCAF12A773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC0020CCF6CCAB45CC88CC94186944CC9BCCFC7D4828CCE0CCC6CC91CCC33D213D62CCDBCCF11022CCE6CC99CC82CCF9CCAACCD01FA773686966746564C082A9756E736869667465649182A474797065A6427566666572A464617461DC002070CCDE0718CCC0CC9BCC9E65CC80CCEF744FCCD4CC8DCCB1CCB1CCD060CCE3CC9246CCFE2FCCD8CCDCCCDA22570D0D1ECC9DA773686966746564C0A661676772656782A9756E736869667465649182A474797065A6427566666572A464617461DC0020CC8F171ECC91CCB1CCEACCFF28CCA7CCD727CCCA54CC85CC8436CC98CCF052CCF3CCD7CCB3CCAB70602D00CCA2CCCCCCA6CCD305A773686966746564C0A772756E74696D65C0A570726F6F6682A871756F7469656E7482A474797065A6427566666572A464617461DC002064585A6E0DCCF5CCCF2DCCF6176B70CCEFCCEE4ACCCA17CCA920CC9D38CCF7546702CCB137CC97CCC9CC95CCB10BA8626C696E64696E6782A474797065A6427566666572A464617461DC00204539CC86CCEC3366773E0E3FCC8D390ECCCACCD2CCAACCA6680FCC9645CCAE6B7154CCDF55CCB0CCA375CC820BA56576616C73DE001AA67075626C696382A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000A1779F82A47A6574619182A474797065A6427566666572A464617461DC0020050013CCB91DCCDFCCF6CCA4CCF1326FCCA968CC92CCCC03CC94CCD02419CCE430CCDECC96052DCCB41DCCDE5FCC982BAA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CCBACCABCCB3CCE7CCC65DCCDC6CCC98CCB1CCE6CCF614CCF2CCE1554204CCD7CC9FCCF179CCF30DCCF5CCE7CCCD164DCCAD5C1682A47A6574619182A474797065A6427566666572A464617461DC002069CC98CC9F14CCF7CC9063CCD3CCB7CCE66C73CCDCCC8F02CCF15D3ACC8D2F70CCD5CCD223CCBBCCA851CCF2CCC163CCBF17AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00202D3ECCDFCCCFCC8011CC9D5ACC901ECCDB74CCC4CCE0CCF1CCD1CC8BCC91CCBACCFA6F5A0B3BCCB8CC83CCEA35CCC55A400582A47A6574619182A474797065A6427566666572A464617461DC0020CC94CCE579CCCA450DCCEA7ACC8939CC85CC8CCCD2656CCCBE41CCB502274ECCF8CCEFCCD34F420824CC81CCF7CCE307AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CC821ACCDB3D2B7252CCA32D53716ACCE403CC8155CCA0CCC95DCCAB741F30CCE8CCB7CC8CCCB36056CCA8CCBC2A82A47A6574619182A474797065A6427566666572A464617461DC00204CCC89CCFACCB36B1717CC99CCC5CCE0CCEDCCFBCCC9CC94CCBECCDD78CCB0CC82767FCCE556CCC4CC99CCB0CCCC20387C000FAA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC002026CCEDCCAB1BCCBA2BCCCF7E39CCAFCCC1CCE103CCC804386CCCBE11CC83CC8274CCA9CCCBCCFD6D70CC92420E280882A47A6574619182A474797065A6427566666572A464617461DC002057CCF3CC83CCD6CCB951CCA1CCFD3F6078CC8C2846CCE6CCB0CCDACCA8457400CC88CCB81F00CCD7CCB63B1BCCD0630DAA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC002070655BCCEC35CCC500CCCBCC88CCA0CCDDCC9FCC822802CCF4CCF24D3ECCB0CC8ECC8B22CCBF21CCBE72CC9721CCE6CC912C82A47A6574619182A474797065A6427566666572A464617461DC002000CC905D2ECCA5CC8FCC86CC8CCCA3CCC2CCC7CCD816695512CCEA347DCC9ECCB4CCC0CCD26250CC87530ACCBF5E670FAA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CCC2CC9FCCFFCCEE6E4ECC845F39CCCACCCA395DCCFD30CCEDCC85CC8BCC930F2CCCA6CCF1CCF83ECCCACCD9784470CCA51D82A47A6574619182A474797065A6427566666572A464617461DC00202D4B1ECC8038CCD5CCABCC9ACCC509450B02CCB1CCF2CCD30ACC9D42CC94CCA8CCF7CCF8CCD1CC817FCC9D370838CCF623AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CCF04374505ECC8CCC81CCBD4D30571ECCB6CC8ACCFD1728CCACCCF363CCD01113CCC10B1307095ECCC2CCF60F82A47A6574619182A474797065A6427566666572A464617461DC0020CC82CCE0CC98CCAD27CCF8CC95CC9A2DCC85CCF7CCE5515F4868CCC8CCD0CC857D312040CCB3CCAE33CCDECCA5CCE5067F21AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CCE4CCAACCCF3DCCACCCD015692ECCC2CCD0CCFCCCFACCC17142CCEBCCE56DCCB0CCDACC88CC805DCCA132CCAD5923CCDE2B0F82A47A6574619182A474797065A6427566666572A464617461DC002046CCA9364B5B6A2FCC8C17CCEF29CCD3CCBB1ACCCACCADCCE1CC9DCCBDCCDFCCAECCCC39CC9143CCAFCC9262CCE5394E0EAA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00201740CCCA00CCDCCC80CCCFCCDA352A6FCCFA51280FCCC2CCC9580BCCA0CCEDCCAB5C21CCA469CCC2CCE16623CCC30582A47A6574619182A474797065A6427566666572A464617461DC00203D78CCB44B76CCB9CC80CCF1CCD771103640CCA7CCBBCCB100CCAFCCC5CCE929CCE573CC9461CCEECCD1CC8B2A63CCB92AAA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00207D714ACCF2CCD2CCA1197ACC9019657F3ECCB8CCEDCCDFCCB6CC9A06CCC7CC864C064DCCCF396FCCACCCFACCA1141682A47A6574619182A474797065A6427566666572A464617461DC0020CCBB16CCC81E1B434ECCB52F313CCCBD4FCCEB5E6506CCCBCCE72ECCF139CC97CCC1310DCCB8CCF3CCAF5FCC9514AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CCC3CC9E19CC94CCF6CC8C24466ACCB5CCF8CCFECCFECCD72718CCC2662227742ECCDA13CC9ECC9A351E07CCC6200982A47A6574619182A474797065A6427566666572A464617461DC0020CCABCC9C392A2B4833021938CCC9CCC5CC855ACCC14E5347CCBACCA5CCBE6BCC9ACCEC5517CCF955CCD2CC94330EAA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CCEB5DCCF4CCA41434CCB562CCE0351F79CCE818CCDFCC900A0ECCCA2FCCAACCC7CCA8CCFD076A16CCEDCCFE66CC802282A47A6574619182A474797065A6427566666572A464617461DC0020CCB4CCF5CCCC5DCC8E6E4E6A196516175FCC9DCCF26CCCD1CCAD127659CCA7062D76CCAFCC850D7ECC8B4B20AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CCF7CCE5CCECCCDDCCC0CCC45FCCC3CC812FCC982300CCA7CCEECCA2CCFBCCDD4F4D2401397DCCA61FCCF3CCC0CCAFCC977D0D82A47A6574619182A474797065A6427566666572A464617461DC0020CC9C4855CCACCCEECCEDCCF4CCC9CCB804273D2ECCD2CCA22F68555ECCA550CC99CCC57ACCDCCCC50621CC89CC97282CAA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CC8C40CCE61A71481F370D67CCB276CCE7531306CCBC49CCEACC8921CC96160CCCAE6BCC8657CCA379CC830D82A47A6574619182A474797065A6427566666572A464617461DC0020CCC656CCA4CCF3CCE2CCE83800CC9A146DCC8FCCC051CCCBCC902560CCD4CCF355CCFD5FCCB522CC8DCCB9457DCCF5CCA201AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC002021CCD508CCA2CC9ACCCD1A4ECCB466CC9938CCC8CCF7CCA2CCEB07CC88CCB52E30CCBDCCB50BCCED3DCC80CCDF39143813A17A82A47A6574619182A474797065A6427566666572A464617461DC00206A08CCE31F08CC8767273E60CCC9CCF2CC986CCCA40ACCCF03CCBDCCB15F4739CC902ECCE51869CCCACCC03D0EAA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC002027CCA3CCF51DCCA0525DCCE6477F4D3ACC81CCCD2BCC987547487349377C575840CCB25760CCA6CCD009A1739682A47A6574619182A474797065A6427566666572A464617461DC00203FCCAD0D4ACCD6CCBDCC86CCADCC930261CCB423CC8B44133F1858CCF20E1BCC99CCC83838CC82CCA86F4DCCB520AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00206852CCC5CCD0383FCCA157CCF869CCEC4A0C382471CC9B124C0F5A45CCFFCCE813CCAF5C535B2BCCE41782A47A6574619182A474797065A6427566666572A464617461DC00201B2F2ACCADCCEC180D0677CCFDCC8E7ECC8B131CCCBFCCA1CCF0CC8B2C67CC98CCFE24CCAE6DCCBA0BCCE16DCCDB23AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CCCACCD05A78CCA7CCAD2CCCBE3019CCEACCBB16CCE4CCB205CCF9CCE6CCA9CC9D14CC9BCC9A1F473F1A4ACCA701CCEA2C82A47A6574619182A474797065A6427566666572A464617461DC0020CCFB034B212DCC9535075ACCA2CCC86ECCF86E736A60CCB8CCC4343DCC9CCCDA5703CCC6CCC611CCE556CCB314AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC002035CCCF4034CCE9CC80CCB80E0ECCC779652F096DCC86734270CCE4CCCB3F7001410ECCEE3642CCE14E1182A47A6574619182A474797065A6427566666572A464617461DC0020691376CC976FCC99653F1BCC9F2C75CCD90A1B7CCCB91FCCA658CC9902CC983F26CC920ECCC54554CCB312AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CCFA745ACCD4CCB905CCD96E1BCCDF30490FCCC1CCDDCCE917CCE629CCFF4060CC95037D36CCB833CCE5CCC1CCD21382A47A6574619182A474797065A6427566666572A464617461DC0020CCBECCA40BCCA1CCB90D465CCC915ECCA55D30CCC145CC8E6CCCA8CCDFCC9C79CCE358CC85CC81551529CCA7CC81CCAA20AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00205917CC8DCCBF02CCE623CCC04321CCD10959CCC0CCCF6A1ECC92753ECCE1CCE8CC85CC8ACCB3CCAE6ACC82CCE2CC93CCCC0082A47A6574619182A474797065A6427566666572A464617461DC0020CCDACC80CCE5CC822ACC824909564ECCED4B1ACCEECCABCCDBCC841A5B02CCB7CCF47617CCAECCC046CCED06405F1CAA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CCBA73234ACCD12CCCC2504F0554CCCC441DCCC1CC881DCCB96C1F14074B430CCCEBCCB824CCDD52CCBB0EAC636F656666696369656E74739F82A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020000000000000000000000000000000000000000000000000000000000000000082A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020000000000000000000000000000000000000000000000000000000000000000082A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020000000000000000000000000000000000000000000000000000000000000000082A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020000000000000000000000000000000000000000000000000000000000000000082A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020000000000000000000000000000000000000000000000000000000000000000082A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020000000000000000000000000000000000000000000000000000000000000000082A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020000000000000000000000000000000000000000000000000000000000000000082A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020000000000000000000000000000000000000000000000000000000000000000082A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020000000000000000000000000000000000000000000000000000000000000000082A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020000000000000000000000000000000000000000000000000000000000000000082A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020000000000000000000000000000000000000000000000000000000000000000082A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020000000000000000000000000000000000000000000000000000000000000000082A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020000000000000000000000000000000000000000000000000000000000000000082A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020000000000000000000000000000000000000000000000000000000000000000082A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000B067656E657269635F73656C6563746F7282A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000B1706F736569646F6E5F73656C6563746F7282A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000B5636F6D706C6574655F6164645F73656C6563746F7282A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AC6D756C5F73656C6563746F7282A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AD656D756C5F73656C6563746F7282A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000B7656E646F6D756C5F7363616C61725F73656C6563746F7282A47A6574619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00200000000000000000000000000000000000000000000000000000000000000000B572616E67655F636865636B305F73656C6563746F7282A47A6574619182A474797065A6427566666572A464617461DC002048CCD10FCCA5CC8F7535CCAC39CC9757CCB84BCCE41CCCA22DCCDD1012CCF0CC9360CCA25CCCC5CCA713CCD7CCA23601AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00206D45CCFC4065CCF328CC9A71CCE1CC9ACCC1CCE9CCD0CCD4CCBF25CCCF0B17CCC7410F3CCCBDCC95CCE653CCF0CCC26D1EB572616E67655F636865636B315F73656C6563746F7282A47A6574619182A474797065A6427566666572A464617461DC0020CCE3CCE9CC9F694929CCAD512E187259CC99CCF02C60CCD6CCE3CCA1CCBCCCA0CC84CCFCCCA33FCCFFCC82CCE76CCCFACCC600AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CCF642CCF829CCB614CCBBCCF9CCC108CC8879CCF5CCD8240ECCBBCC83CC9E7CCCA6CCC8CCA3CC89CCB844CCE92126470F13BA666F726569676E5F6669656C645F6164645F73656C6563746F72C0BA666F726569676E5F6669656C645F6D756C5F73656C6563746F72C0AC786F725F73656C6563746F72C0AC726F745F73656C6563746F72C0B26C6F6F6B75705F6167677265676174696F6E82A47A6574619182A474797065A6427566666572A464617461DC0020281CCC9DCCA2CCE7CCB2CCA53FCCEBCC971F2B5E777ECC9CCCDC565E1C5B5835CCC3CCAD135DCC8616CC8FCC9301AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CCFD596F35CCC6CC9139CCB2CC96CCA1CCB416CCDBCCAECCD44B35042ACCD7CCF9CC8708CCE3CC8101CC9BCCA10ACCD53210AC6C6F6F6B75705F7461626C6582A47A6574619182A474797065A6427566666572A464617461DC0020CCDF25CC83CC95CC90CCD61024CCAB7E4930CCE40A5FCCB40DCCBECCE4CC9C025117CC9F36CCE7CCCF350DCCEFCC9F03AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CCA1CCE1CCACCCC06B56CCC1031BCCA870CC9FCCDB2ECCBF28CC98CCF9CCFB41CCE204CCDDCCE719687268CCB8CCD4CC9F22AD6C6F6F6B75705F736F727465649582A47A6574619182A474797065A6427566666572A464617461DC002039791556CCCB09CC8C3F4C12CCD3CCC5417FCCECCCB0CCB962CC842950CC8F55CCE4CC8CCCA0CCB8CCCF161ECC8828AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CCBCCCE141CCA72C3F77CCFD6DCCAA15CCEC3FCCCECCFF6F5863CCD21B300D6FCCD125CCB7636FCCF0CCC1CCBE2682A47A6574619182A474797065A6427566666572A464617461DC0020CC8E44CCF5CCB2CCFF15CC94CCA4CCB1CCE8CCA55E0244CCE1CCCCCCD41C101DCCDE6B7127CC8B65CCFACCE532CCFACCCA2BAA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00206574CCBFCCC04A4FCCBC0D26CCF50A5BCCEE4DCC9A1833CCDF3BCCD1CCA5CCC650CC8FCCDCCCE11ACCA0CCA12E652B82A47A6574619182A474797065A6427566666572A464617461DC0020341ACCDCCCC3CCBD523ACC897D267ECCE07601CCC0CCFACCB9CCEC01156250CCF1CCF7CCCECCDACCC9CCADCCC42F1711AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CCFC2ACCF35E38CCFD04467ACCFFCCBFCCA3CCF26802CCAC52074ACCE45ACCCFCCB0CCF9CC9770CCE421CC87CCA3CCCB1B82A47A6574619182A474797065A6427566666572A464617461DC00200F3ECCD8CCFD0040CCA5467BCC93CCB51372036BCCF60547CCB9CCAE0CCCA0CCBE0E4DCC88391B6F355425AA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00204B2ACCAF3D49CCD4CCBB0454CCFACCFA64CCF253CCBA69CC86CCF161CCB21C7BCCEB6F7F3A7E73CC8C404D2082A47A6574619182A474797065A6427566666572A464617461DC002009CCDACCED6237CCCECCEECCA04A02CCA9CCDD0BCCB3CCBD667CCCBC3540CC9F570ACCE8513C7557CC83CCF0CCCA0FAA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC0020CCC22CCC95CCB03FCCA5CCA3CC93CC9FCCF8CC8C08CCB816CCD66F327759CCCC13CCA27201CCE103151D1258661DB472756E74696D655F6C6F6F6B75705F7461626C65C0BD72756E74696D655F6C6F6F6B75705F7461626C655F73656C6563746F72C0B3786F725F6C6F6F6B75705F73656C6563746F72C0BB6C6F6F6B75705F676174655F6C6F6F6B75705F73656C6563746F72C0BB72616E67655F636865636B5F6C6F6F6B75705F73656C6563746F7282A47A6574619182A474797065A6427566666572A464617461DC00206ACC93CC862A5FCCC121CCF306CCB7CCA4CC8527CCCC7446CCE91CCCAFCC9A75CCB718416A3ECCFF3557CCE6681AAA7A6574615F6F6D6567619182A474797065A6427566666572A464617461DC00204572CC94CCE4CCD03BCCAFCCA1CCD0CC91CCDB1A30CCB2CCF2055ACCDECCCACCCE57495FCCB1CC8B39217C10CCB6CCDF01D921666F726569676E5F6669656C645F6D756C5F6C6F6F6B75705F73656C6563746F72C0A866745F6576616C3182A474797065A6427566666572A464617461DC0020CCCBCCD2CCE1CCCECC8B2DCCECCCED1CCCD86256CC84CC94211A434C206D2DCCFB3ACCC501CC9ECCD4326BCCF14612AF707265765F6368616C6C656E67657390";
    bytes urs_serialized =
        hex"82A866756C6C5F73727382A1679382A474797065A6427566666572A464617461DC0020010000000000000000000000000000000000000000000000000000000000000082A474797065A6427566666572A464617461DC0020343FCC9B2FCC88177D5317CCC5CCE46D58775535CCFBCCF727CCAECCFDCC9ACC8F7CCCD71FCC97CCB65DCCF3CC88CC8982A474797065A6427566666572A464617461DC00204A43CCA4CC91CCBECCFACCA9CCF4CC8307CCAB053DCCE15301CC8904CC885BCCB27ECC8F547A4E1FCCD0CC8BCC864B0DA16882A474797065A6427566666572A464617461DC0020723737CCCF1CCCC96BCCB40021504A4FCCF45D21CC914ECC94CC84CCF2113D66545A3826CC91CC9ACC9C25AC76657269666965725F73727382A1679382A474797065A6427566666572A464617461DC0040CCEDCCF6CC92CCD95CCCBDCCDE46CCDDCCDA5ECCF7CCD422436779445C5E66006A42761E1F12CCEFCCDE0018CCC212CCF3CCAECCB7CC85CCE4CC9712CCE7CCA9353349CCAACCF1255DCCFB31CCB7CCBF60723A480DCC92CC93CC93CC8E1982A474797065A6427566666572A464617461DC0040CCE7CCE6CCAFCC991BCC936DCCD662CCCACCAE0472CCBA13CC801C5F3ACCA3CCAD44CC863D0F090DCC9ACCC8CCA86D11CC91CC9A5606733ACC9E0630CCA5CCE2CCD0CCB1670DCCE93CCCE8CCCC6FCCB0496A7BCCB715CC96CCBA340974CC9282A474797065A6427566666572A464617461DC0040CCA50DCCF21272CCDA0FCC9044CCEACCE527CCA975CCCC3619CCD5CCEB45CCA57A7B3203472A20CCCB073C1FCCF74FCCF90657CCBDCCBECCE361CCD2CC90CCFACCB566CCF5CC8FCCC8CC921F7646CC8DCCEF43CC94CCB6611D25CC9242CC8AA16882A474797065A6427566666572A464617461DC00406959CCBECCF6615463CCA54CCCA6CCC72DCCFCCCD02B6B77CC9ECCDE23400D55CCB043CC984B2206CC92012A00CCF4CCA9CCF6CCBDCCB1CCD34ECCD1CCA57C0E4140CCA0CCCFCCF3CCEFCCB0CCCE24CC844CCCC6CCEDCC9DCCA8CCFC573ECC982D";
    bytes32 numerator_binary =
        0x5535ff2598e5112ac326026f511767945090e31bd70137f3b5f833b96e780f25;

    function test_verify_with_index() public {
        KimchiVerifier verifier = new KimchiVerifier();

        verifier.setup(urs_serialized);

        bool success = verifier.verify_with_index(
            verifier_index_serialized,
            prover_proof_serialized,
            numerator_binary
        );

        require(success, "Verification failed!");
    }

    function test_partial_verify() public {
        KimchiVerifier verifier = new KimchiVerifier();

        verifier.setup(urs_serialized);
        verifier.deserialize_proof(verifier_index_serialized, prover_proof_serialized);
        verifier.partial_verify(new Scalar.FE[](0));
    }
}
